# MongoDB Shell Tutorial â€“ Complete Guide with Sample Data

This guide focuses **only on the MongoDB shell commands** (mongosh). You'll learn everything from creating databases and collections to querying, updating, and optimizing with indexes.  
At the end, you'll find a **sample data challenge** so you can practice all commands on a realistic dataset.

---

## ðŸ“ Sample Data Challenge (School Database)

Before diving into commands, here's the dataset we'll use throughout this tutorial.  
Create a database called `school` and a collection named `students` with the following documents:

```javascript
// Use the school database
use school

// Insert sample students
db.students.insertMany([
  {
    name: "SpongeBob",
    age: 30,
    gpa: 3.2,
    fullTime: false,
    registrationDate: new Date(),
    graduationDate: null,
    courses: ["biology", "chemistry", "calculus"],
    address: { street: "123 Fake St", city: "Bikini Bottom", zip: 12345 }
  },
  {
    name: "Patrick",
    age: 38,
    gpa: 1.5,
    fullTime: false,
    registrationDate: new Date("2023-01-15"),
    graduationDate: null,
    courses: ["biology"],
    address: { street: "456 Rock Rd", city: "Bikini Bottom", zip: 12345 }
  },
  {
    name: "Sandy",
    age: 27,
    gpa: 4.0,
    fullTime: true,
    registrationDate: new Date("2023-03-20"),
    graduationDate: null,
    courses: ["chemistry", "physics", "math"],
    address: { street: "789 Treetop Ln", city: "Bikini Bottom", zip: 12345 }
  },
  {
    name: "Gary",
    age: 18,
    gpa: 2.5,
    fullTime: true,
    registrationDate: new Date("2023-08-01"),
    graduationDate: null,
    courses: ["biology", "math"],
    address: { street: "123 Fake St", city: "Bikini Bottom", zip: 12345 }
  },
  {
    name: "Larry",
    age: 32,
    gpa: 2.8,
    fullTime: false,
    registrationDate: new Date("2022-09-10"),
    graduationDate: null,
    courses: ["chemistry"],
    address: { street: "321 Lobster Ln", city: "Bikini Bottom", zip: 12345 }
  }
])
```

> **Note**: The `_id` field is automatically generated by MongoDB. You can ignore it for now.

Now you have a working dataset to practice all the commands below.

---

## ðŸ—„ï¸ Database Operations

### Show all databases
```javascript
show dbs
```

### Switch to (or create) a database
```javascript
use school
```
> If the database doesn't exist, it will be created when you first insert data.

### Create a collection explicitly
```javascript
db.createCollection("teachers")
```

### Drop (delete) the current database
```javascript
db.dropDatabase()
```

### Show collections in current database
```javascript
show collections
```

### Drop a collection
```javascript
db.teachers.drop()
```

---

## ðŸ“¥ Insert Documents

### Insert one document
```javascript
db.students.insertOne({ name: "Pearl", age: 16, gpa: 3.8 })
```

### Insert multiple documents
```javascript
db.students.insertMany([
  { name: "Plankton", age: 45, gpa: 3.0 },
  { name: "Karen", age: 42, gpa: 3.5 }
])
```

---

## ðŸ” Find / Query Documents

### Find all documents
```javascript
db.students.find()
```

### Find with query filter (WHERE clause)
```javascript
db.students.find({ name: "SpongeBob" })
db.students.find({ gpa: 4.0 })
db.students.find({ fullTime: false })
```

### Find with multiple conditions (implicit AND)
```javascript
db.students.find({ gpa: 4.0, fullTime: true })
```

### Projection (select only specific fields)
```javascript
// Return only name and gpa, exclude _id
db.students.find({}, { name: true, gpa: true, _id: false })
```

---

## ðŸ“Š Sort and Limit

### Sort (1 = ascending, -1 = descending)
```javascript
// Alphabetical by name
db.students.find().sort({ name: 1 })

// By GPA descending (highest first)
db.students.find().sort({ gpa: -1 })
```

### Limit number of results
```javascript
db.students.find().limit(3)
```

### Combine sort and limit (e.g., student with highest GPA)
```javascript
db.students.find().sort({ gpa: -1 }).limit(1)
```

---

## âœï¸ Update Documents

### Update one document
```javascript
db.students.updateOne(
  { name: "SpongeBob" },           // filter
  { $set: { fullTime: true } }      // update
)
```

### Update by `_id` (safer)
```javascript
db.students.updateOne(
  { _id: ObjectId("...") },
  { $set: { fullTime: false } }
)
```

### Remove a field (`$unset`)
```javascript
db.students.updateOne(
  { name: "SpongeBob" },
  { $unset: { fullTime: "" } }
)
```

### Update many documents
```javascript
// Set fullTime to false for all students
db.students.updateMany(
  {},
  { $set: { fullTime: false } }
)

// Set fullTime to true for students who don't have the field
db.students.updateMany(
  { fullTime: { $exists: false } },
  { $set: { fullTime: true } }
)
```

---

## âŒ Delete Documents

### Delete one document
```javascript
db.students.deleteOne({ name: "Larry" })
```

### Delete many documents
```javascript
// Delete all part-time students
db.students.deleteMany({ fullTime: false })

// Delete students missing a registrationDate
db.students.deleteMany({ registrationDate: { $exists: false } })
```

---

## ðŸ”§ Comparison Operators

| Operator | Meaning          | Example                                      |
|----------|------------------|----------------------------------------------|
| `$ne`    | not equal        | `{ age: { $ne: 30 } }`                       |
| `$lt`    | less than        | `{ age: { $lt: 20 } }`                        |
| `$lte`   | less than or equal | `{ age: { $lte: 27 } }`                     |
| `$gt`    | greater than     | `{ age: { $gt: 27 } }`                        |
| `$gte`   | greater than or equal | `{ age: { $gte: 27 } }`                   |
| `$in`    | in array         | `{ name: { $in: ["SpongeBob", "Patrick"] } }` |
| `$nin`   | not in array     | `{ name: { $nin: ["SpongeBob", "Patrick"] } }`|

Examples:
```javascript
// Students older than 27
db.students.find({ age: { $gt: 27 } })

// Students named either Sandy or Gary
db.students.find({ name: { $in: ["Sandy", "Gary"] } })
```

---

## ðŸ§  Logical Operators

### `$and` â€“ both conditions true
```javascript
db.students.find({
  $and: [
    { fullTime: true },
    { age: { $lte: 22 } }
  ]
})
```

### `$or` â€“ at least one condition true
```javascript
db.students.find({
  $or: [
    { fullTime: true },
    { age: { $lte: 22 } }
  ]
})
```

### `$nor` â€“ both conditions false
```javascript
db.students.find({
  $nor: [
    { fullTime: true },
    { age: { $lte: 22 } }
  ]
})
```

### `$not` â€“ negates a condition (includes nulls)
```javascript
// Students whose age is NOT >= 30 (includes null ages)
db.students.find({ age: { $not: { $gte: 30 } } })
```

---

## âš¡ Indexes

### Create an index on a field
```javascript
db.students.createIndex({ name: 1 })   // 1 = ascending
```

### View all indexes on a collection
```javascript
db.students.getIndexes()
```

### Drop an index (by name)
```javascript
db.students.dropIndex("name_1")
```

### Analyze query performance with `explain()`
```javascript
db.students.find({ name: "Larry" }).explain("executionStats")
```
> Without an index, it scans all documents; with an index, it scans only the matching ones.

---

## ðŸ“š Advanced Collection Options

### Create a capped collection (with max size and max documents)
```javascript
db.createCollection("teachers", {
  capped: true,
  size: 10000000,      // 10 MB
  max: 100,            // maximum 100 documents
  autoIndexId: false   // do not automatically index _id
})
```

---

## âœ… Summary of Essential Shell Commands

| Operation | Command Example |
|-----------|-----------------|
| Switch DB | `use school` |
| Show DBs  | `show dbs` |
| Show collections | `show collections` |
| Insert one | `db.students.insertOne({...})` |
| Insert many | `db.students.insertMany([...])` |
| Find all | `db.students.find()` |
| Find with filter | `db.students.find({ age: { $gt: 25 } })` |
| Update one | `db.students.updateOne({filter}, {$set: {...}})` |
| Update many | `db.students.updateMany({filter}, {$set: {...}})` |
| Delete one | `db.students.deleteOne({filter})` |
| Delete many | `db.students.deleteMany({filter})` |
| Sort | `db.students.find().sort({ gpa: -1 })` |
| Limit | `db.students.find().limit(5)` |
| Create index | `db.students.createIndex({ name: 1 })` |
| Drop index | `db.students.dropIndex("name_1")` |
| Drop collection | `db.students.drop()` |
| Drop database | `db.dropDatabase()` |

---

Now you're ready to experiment with the sample data. Try combining operators, updating nested documents, and testing indexes on larger datasets. Happy coding! ðŸš€